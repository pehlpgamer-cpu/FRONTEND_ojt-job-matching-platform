<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../css/register.css"/>
    <link rel="stylesheet" href="../../css/global.css"/>
    <title>Register</title>
</head>
<body onload="validatePassword(); resetPassRequirementFeedback()" class="centerForm">
    
    <!-- TODO input validation using JS -->
    
        <form onsubmit="(e) => {e.preventDefault()}" class="form">

            <label>First name</label>
            <input oninput="autoTrimInputs()" id="firstnameInput" class="textbox" type="text"/>
            <label id="firstnameError"></label>
            
            <label>Middle name</label>
            <input oninput="autoTrimInputs()" id="lastnameInput" class="textbox" type="text"/>
            <label id="lastnameError"></label>


            <label>Last name</label>
            <input oninput="autoTrimInputs()" id="middlenameInput" class="textbox" type="text"/>
            <label id="middlenameError"></label>
            
            <label>Email</label>
            <input oninput="autoTrimInputs()" id="emailInput" class="textbox" type="text"/>
            <label id="emailError"></label>

            <label>Password</label>
            <section class="pwdAndPwdRequirementsContainer">
                <div class="passwordContainer">
                    <input oninput="validatePassword()" id="passwordInput" class="textbox" type="password"/>
                    <button onclick="togglePasswordVisibility()" type="button">view</button>
                    <button onclick="generateRandomPassword()" type="button">ðŸŽ²</button>
                </div>
                <section class="passwordRequirementContainer">
                    <label id="MinCharsPwdRequirement">âœ• 8 chars minimum</label>
                    <label id="MaxCharsPwdRequirement">âœ• 64 chars maximum</label>
                    <label id="SpecialCharPwdRequirement">âœ• 1 special char</label>
                    <label id="numberPwdRequirement">âœ• 1 number</label>
                    <label id="uppercasePwdRequirement">âœ• 1 uppercase</label>
                    <label id="lowercasePwdRequirement">âœ• 1 lowercase</label>
                </section>
            </section>
            
            
            <label>Confirm password</label>
            <div class="passwordContainer">
                <input oninput="autoTrimInputs()" id="confirmPasswordInput" class="textbox" type="password"/>
                <button onclick="toggleConfirmPasswordVisibility()" type="button">view</button>
            </div>
            <label id="confirmPasswordError"></label>
            
            <div>
                <input class="textbox" type="checkbox"/>
                <label>Do you agree with the terms and conditions?</label>
            </div>

            <button type="submit" class="registerBtn">Register</button>
            <a href="./login.html" class="link">Already have an account?</a>
            

        </form>
    

    <script>
        // inputs
        const usernameInput = document.getElementById('usernameInput');
        const emailInput = document.getElementById('emailInput');
        const passwordInput = document.getElementById('passwordInput');
        const confirmPasswordInput = document.getElementById('confirmPasswordInput');

        // pass requirements
        const MinCharsPwdRequirement = document.getElementById('MinCharsPwdRequirement');
        const MaxCharsPwdRequirement = document.getElementById('MaxCharsPwdRequirement');
        const SpecialCharPwdRequirement = document.getElementById('SpecialCharPwdRequirement');
        const numberPwdRequirement = document.getElementById('numberPwdRequirement');
        const uppercasePwdRequirement = document.getElementById('uppercasePwdRequirement');
        const lowercasePwdRequirement = document.getElementById('lowercasePwdRequirement');
       
        
        

        function togglePasswordVisibility() {
            if (passwordInput.getAttribute('type') == 'password') passwordInput.setAttribute('type', 'text');
            else passwordInput.setAttribute('type', 'password');
        }
        
        function toggleConfirmPasswordVisibility() {
            if (confirmPasswordInput.getAttribute('type') == 'password') confirmPasswordInput.setAttribute('type', 'text');
            else confirmPasswordInput.setAttribute('type', 'password');
        }

        function generateRandomPassword()
        {
            // FIXME works only once and doesn't override user's input
            const randomPassword = "123"; // WIP
            passwordInput.setAttribute('value', randomPassword);
            confirmPasswordInput.setAttribute('value', randomPassword);
            
        }

        function handleSubmit(event) {
            event.preventDefault();
        }

        

        function autoTrimInputs()
        {
            usernameInput.value = usernameInput.value.trim();
            emailInput.value = emailInput.value.trim();
            passwordInput.value = passwordInput.value.trim();
            confirmPasswordInput.value = confirmPasswordInput.value.trim();   
        }

        
        function resetPassRequirementFeedback() {
            // TODO low priority - make use of array and loop to reduce code 
            MinCharsPwdRequirement.classList.add('invalidPassword');
            MinCharsPwdRequirement.classList.remove('validPassword');

            MaxCharsPwdRequirement.classList.add('invalidPassword');
            MaxCharsPwdRequirement.classList.remove('validPassword');

            SpecialCharPwdRequirement.classList.add('invalidPassword');
            SpecialCharPwdRequirement.classList.remove('validPassword');
            
            numberPwdRequirement.classList.add('invalidPassword');
            numberPwdRequirement.classList.remove('validPassword');

            uppercasePwdRequirement.classList.add('invalidPassword');
            uppercasePwdRequirement.classList.remove('validPassword');

            lowercasePwdRequirement.classList.add('invalidPassword');
            lowercasePwdRequirement.classList.remove('validPassword');
            
            
            // Reset text content to show âœ• symbol
            MinCharsPwdRequirement.textContent = 'âœ• 8 chars minimum';
            MaxCharsPwdRequirement.textContent = 'âœ• 64 chars maximum';
            SpecialCharPwdRequirement.textContent = 'âœ• 1 special char';
            numberPwdRequirement.textContent = 'âœ• 1 number';
            uppercasePwdRequirement.textContent = 'âœ• 1 uppercase';
            lowercasePwdRequirement.textContent = 'âœ• 1 lowercase';
            
        }

        function validatePassword() {
            
            resetPassRequirementFeedback();
            if (passwordInput.value.length >= 8) {
                MinCharsPwdRequirement.setAttribute('class', 'validPassword');
                MinCharsPwdRequirement.textContent = 'âœ“ 8 chars minimum';
            }

            if (passwordInput.value.length <= 64 && passwordInput.value.length > 0) {
                MaxCharsPwdRequirement.setAttribute('class', 'validPassword');
                MaxCharsPwdRequirement.textContent = 'âœ“ 64 chars maximum';
            }


            if (/[!@#$%^&*(),.?":{}|<>_]/.test(passwordInput.value)) {
                SpecialCharPwdRequirement.setAttribute('class', 'validPassword');
                SpecialCharPwdRequirement.textContent = 'âœ“ 1 special char';
            }

            if (/[0-9]/.test(passwordInput.value))
            {
                numberPwdRequirement.setAttribute('class', 'validPassword');
                numberPwdRequirement.textContent = 'âœ“ 1 number';
            }

            if (/[A-Z]/.test(passwordInput.value))
            {
                uppercasePwdRequirement.setAttribute('class', 'validPassword');
                uppercasePwdRequirement.textContent = 'âœ“ 1 uppercase';
            }

            if (/[a-z]/.test(passwordInput.value))
            {
                lowercasePwdRequirement.setAttribute('class', 'validPassword');
                lowercasePwdRequirement.textContent = 'âœ“ 1 lowercase';
            }

        }


        
        
    </script>
    
</body>
</html>